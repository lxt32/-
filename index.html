<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="UTF-8">
  <title>飛鼠逃跑了嗚嗚嗚⁵ ₅</title>
  <style>
    /* Update font-family globally */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: '俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      overflow: hidden;
      color: #fff;
      background: #000;
    }
    /* 首頁背景設計 */
    #page1 {
      background-image: url('圖片/1.landing.webp');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      position: absolute;
      top: 0; left: 0; width: 100vw; height: 100vh;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    /* 標題 */
    .banner-title {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      font-weight: bold;
      font-size: 3.5rem;
      color: #fff;
      margin-top: 90px;
      margin-bottom: 0;
      letter-spacing: 0.08em;
      text-align: center;
      text-shadow: 0 2px 8px rgba(0,0,0,0.18);
    }
    /* 巫師圖片 */
    .wizard-img {
      position: absolute;
      top: 40px;
      right: 80px;
      width: 320px;
      max-width: 38vw;
      z-index: 2;
      animation: wizardFloat 2.5s infinite ease-in-out alternate;
    }
    @keyframes wizardFloat {
      0% { transform: translateY(0); }
      100% { transform: translateY(-18px); }
    }
    /* 白框 */
    .custom-info-box {
      background: rgba(211,214,219,0.8);
      border-radius: 24px;
      box-shadow: 0 5px 20px rgba(128,128,128,0.18);
      padding: 48px 60px 38px 60px;
      min-width: 500px;
      max-width: 700px;
      margin: 0 auto;
      margin-top: 180px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    .custom-info-text {
      font-size: 2rem;
      color: #222;
      text-align: center;
      line-height: 1.6;
      margin-bottom: 32px;
      font-family: '俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
    }
    .custom-btn {
      background: #7691FF;
      color: #fff;
      border: none;
      border-radius: 24px;
      font-size: 1.3rem;
      padding: 16px 48px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(128,128,128,0.18);
      font-family: '俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;
      transition: background 0.2s;
    }
    .custom-btn:hover {
      background: #5a6fd6;
    }
    .page {
      display: none;
      position: absolute;
      top: 0; left: 0; width: 100vw; height: 100vh;
      background-size: cover;
      background-position: center;
      z-index: 1;
    }
    .active { display: block; }
    .back-btn {
      position: absolute; top: 32px; left: 32px;
      width: 48px; height: 48px;
      background: none;
      border: none;
      display: flex; align-items: center; justify-content: center;
      font-size: 3rem;
      font-weight: bold;
      color: #7691FF;
      box-shadow: none;
      cursor: pointer; z-index: 10;
      border-radius: 0;
      transition: color 0.2s;
    }
    .back-btn:hover { color: #5a6fd6; }
    .decor { position: absolute; z-index: 2; pointer-events: none; }
    .left-bottom { left: 3vw; bottom: 3vh; width: 180px; }
    .right-top { right: 5vw; top: 5vh; width: 220px; }
    .slide-in { animation: wizardSlideIn 1.2s cubic-bezier(.68,-0.55,.27,1.55) forwards, wizardFloat 2.5s 1.2s infinite ease-in-out alternate; }
    @keyframes wizardSlideIn { 0% { right: -300px; } 100% { right: 5vw; } }
    @keyframes wizardFloat { 0% { transform: translateY(0); } 100% { transform: translateY(-20px); } }
    .chase { animation: chaseMove 2.2s infinite alternate ease-in-out; }
    @keyframes chaseMove { 0% { transform: translateX(0); } 100% { transform: translateX(40px); } }
    .info-box {
      background: rgba(255,255,255,0.7);
      border-radius: 25%;
      box-shadow: 0 5px 20px rgba(128,128,128,0.5);
      padding: 50px;
      min-width: 350px;
      min-height: 120px;
      z-index: 3;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 1;
      margin: 24px auto;
      text-align: center;
    }
    .info-text {
      font-size: 1.5rem;
      color: #222;
      text-align: center;
      white-space: pre-line;
      margin-bottom: 40px;
    }
    .primary-btn, .submit-btn, .next-btn {
      background: #7691FF;
      color: #fff;
      border: 3px solid #fff;
      border-radius: 50%;
      font-size: 1.3rem;
      padding: 18px 48px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(128,128,128,0.3);
      margin-top: 20px;
      margin-bottom: 10px;
      opacity: 1;
      transition: opacity 0.5s;
      z-index: 4;
    }
    .hidden { display: none !important; }
    /* 白框位置調整 */
    #box2 { transform: translate(250px, -250px); }
    #box3 { transform: translate(-250px, -200px); }
    #box4 { transform: translate(250px, -150px); }
    #box5 { width:1130px; height:490px; margin:0 auto; }
    #box7 { width:1200px; height:700px; margin:40px; align-items:flex-start; }
    #box8 { margin:0; align-items:flex-start; }
    /* 咒語輸入框 */
    #answer {
      font-size: 2.5rem;
      letter-spacing: 2.5rem;
      background: none;
      border: none;
      outline: none;
      text-align: center;
      margin-top: 40px;
      color: #222;
      width: 400px;
      caret-color: #7691FF;
    }
    /* 第八頁按鈕位置 */
    #nextAfterWin {
      position: absolute;
      right: 5vw;
      top: 50%;
      transform: translateY(-50%);
      margin-top: 0;
      margin-bottom: 0;
    }
    /* Redesign seventh page */
    #page7 {
      background-image: url('圖片/7.輸入咒語.webp');
      background-size: cover;
      background-position: center;
    }
    .page-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
    .info-box {
      background: #D3D6DB;
      border-radius: 24px;
      box-shadow: 0 5px 20px rgba(128, 128, 128, 0.18);
      padding: 48px 60px;
      width: 700px;
      text-align: center;
    }
    .info-text {
      font-size: 2rem;
      color: #222;
      margin-bottom: 32px;
    }
    .primary-btn {
      background: #7691FF;
      color: #fff;
      border: none;
      border-radius: 24px;
      font-size: 1.3rem;
      padding: 16px 48px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(128, 128, 128, 0.18);
      margin-top: 20px;
      transition: background 0.2s;
    }
    .primary-btn:hover {
      background: #5a6fd6;
    }
    /* 修正第七頁設計 */
    #page7 {
      background-image: url('圖片/7.輸入咒語.webp');
      background-size: cover;
      background-position: center;
    }
    .page-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
    .info-box {
      background: #D3D6DB;
      border-radius: 24px;
      box-shadow: 0 5px 20px rgba(128, 128, 128, 0.18);
      padding: 48px 60px;
      width: 700px;
      text-align: center;
    }
    .info-text {
      font-size: 2rem;
      color: #222;
      margin-bottom: 32px;
    }
    .primary-btn {
      background: #7691FF;
      color: #fff;
      border: none;
      border-radius: 24px;
      font-size: 1.3rem;
      padding: 16px 48px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(128, 128, 128, 0.18);
      margin-top: 20px;
      transition: background 0.2s;
    }
    .primary-btn:hover {
      background: #5a6fd6;
    }

    /* 修正第7-1頁設計 */
    #page7_1 {
      background-image: url('圖片/7-1.答錯.webp');
      background-size: cover;
      background-position: center;
    }
    .page-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
    .info-box {
      background: #D3D6DB;
      border-radius: 24px;
      box-shadow: 0 5px 20px rgba(128, 128, 128, 0.18);
      padding: 48px 60px;
      width: 700px;
      text-align: center;
    }
    .info-text {
      font-size: 2rem;
      color: #222;
      margin-bottom: 32px;
    }

    /* 修正第7-2頁設計 */
    #page7_2 {
      background-image: url('圖片/7-2.提示.webp');
      background-size: cover;
      background-position: center;
    }
    .page-center {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
    .info-box {
      background: #D3D6DB;
      border-radius: 24px;
      box-shadow: 0 5px 20px rgba(128, 128, 128, 0.18);
      padding: 48px 60px;
      width: 700px;
      text-align: center;
    }
    .info-text {
      font-size: 2rem;
      color: #222;
      margin-bottom: 32px;
    }
    .primary-btn {
      background: #7691FF;
      color: #fff;
      border: none;
      border-radius: 24px;
      font-size: 1.3rem;
      padding: 16px 48px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(128, 128, 128, 0.18);
      margin-top: 20px;
      transition: background 0.2s;
    }
    .primary-btn:hover {
      background: #5a6fd6;
    }

    /* 淡入動畫效果 */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* 套用到所有文字框 */
    .custom-info-box, 
    .info-box,
    div[style*="background:rgba"],
    div[style*="background: rgba"] {
      animation: fadeIn 0.5s ease-in !important;
    }
  </style>
</head>
<body>
  <!-- Pages 1..8 redesigned -->

  <!-- 第一頁：Landing -->
  <div id="page1" class="page active">
    <h1 class="banner-title" style="font-family:'俐方體11號'">飛鼠逃跑了嗚嗚嗚⁵ ₅</h1>
    <img src="圖片/魔法師飛行.webp" alt="魔法師飛行" class="wizard-img">
    <div class="custom-info-box">
      <div class="custom-info-text">巫師自古以來負責守護文山地區的和平，<br>將難搞的怪物飛鼠封印在山上，<br>直到這天⋯⋯</div>
      <button class="custom-btn" id="startBtn">開始遊戲</button>
    </div>
  </div>

  <!-- 第二頁 -->
  <div id="page2" class="page" style="background-image: url('圖片/2.轉折.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <!-- 飛鼠圖片 -->
    <img src="圖片/追逐飛鼠.webp" alt="追逐飛鼠" style="position:absolute; left:320px; bottom:150px; width:320px; z-index:2;">
    <!-- 白框與按鈕 -->
    <div style="position:absolute; top:140px; right:60px;">
      <div style="background:rgba(211,214,219,0.75); border-radius:24px; box-shadow:0 5px 20px rgba(128,128,128,0.18); padding:40px 50px 30px 50px; width:650px; text-align:center;">
        <div style="font-size:1.8rem; color:#222; line-height:1.5; margin-bottom:24px; font-family:'俐方體11號','Noto Sans TC','Microsoft JhengHei',Arial,sans-serif;">
          飛鼠毫無預警的出現在指南山下！！<br>如果飛鼠順利逃脫文山封印，<br>整個台北都將受害！
        </div>
        <button class="custom-btn" id="btn2" onclick="showPage(3)" style="margin-top:0;">巫師人呢？！</button>
      </div>
    </div>
  </div>

  <!-- 第三頁 -->
  <div id="page3" class="page" style="background-image: url('圖片/3.視覺噪音.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <!-- 白框與按鈕 -->
    <div style="position:absolute; top:180px; left:200px;">
      <div style="background:rgba(211,214,219,0.75); border-radius:24px; box-shadow:0 5px 20px rgba(128,128,128,0.18); padding:40px 50px 30px 50px; width:650px; text-align:center;">
        <div style="font-size:1.8rem; color:#222; line-height:1.5; margin-bottom:24px; font-family:'俐方體11號','Noto Sans TC','Microsoft JhengHei',Arial,sans-serif;">
          原來，<br>自從前幾天巫師收到一份神秘禮物之後，<br>便難以抵抗視覺噪音的影響，<br>把封印咒語弄丟了⋯⋯
        </div>
        <button class="custom-btn" id="btn3" onclick="showPage(4)">該怎麼辦？！</button>
      </div>
    </div>
  </div>

  <!-- 第四頁 -->
  <div id="page4" class="page" style="background-image: url('圖片/4.闖關說明.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <!-- 白框與按鈕 -->
    <div style="position:absolute; top:50%; left:68%; transform:translate(-50%,-50%);">
      <div style="background:rgba(211,214,219,0.75); border-radius:24px; box-shadow:0 5px 20px rgba(128,128,128,0.18); padding:48px 60px 38px 60px; min-width:500px; max-width:700px; height:260px; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
        <div style="font-size:2rem; color:#222; line-height:1.6; margin-bottom:32px; font-family:'俐方體11號','Noto Sans TC','Microsoft JhengHei',Arial,sans-serif;">
          請依照桌面上的實體關卡說明<br>過濾視覺噪音
        </div>
        <button class="custom-btn" id="btn4">幫助巫師找回咒語！</button>
      </div>
    </div>
  </div>

  <!-- 第五頁 -->
  <div id="page5" class="page" style="background-image: url('圖片/5.闖關完成.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <!-- 白框與按鈕 -->
    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);">
      <div style="background:rgba(211,214,219,0.75); border-radius:24px; box-shadow:0 5px 20px rgba(128,128,128,0.18); padding:48px 60px 38px 60px; width:900px; height:340px; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
        <div style="font-size:2rem; color:#222; line-height:1.6; margin-bottom:32px; font-family:'俐方體11號','Noto Sans TC','Microsoft JhengHei',Arial,sans-serif;">
          闖完所有關卡了嗎？
        </div>
        <button class="custom-btn" id="btn5">闖完了！</button>
      </div>
    </div>
  </div>

  <!-- 第六頁：原先第三頁的小遊戲 -->
  <div id="page6" class="page" style="background-image: url('圖片/6.彈出式網頁.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <!-- 白框說明 -->
    <div style="position:absolute; top:60px; left:50%; transform:translateX(-50%);">
      <div style="background:rgba(211,214,219,0.75); border-radius:24px; box-shadow:0 5px 20px rgba(128,128,128,0.18); padding:38px 60px 28px 60px; min-width:500px; max-width:700px; text-align:center;">
        <div style="font-size:2rem; color:#222; line-height:1.6; font-family:'俐方體11號','Noto Sans TC','Microsoft JhengHei',Arial,sans-serif;">
          噢不！<br>巫師再次受到視覺噪音攻擊，<br>需要觀眾幫忙按掉所有視窗才能通關
        </div>
      </div>
    </div>
    <!-- 互動區域 -->
    <div id="gameArea" style="position:absolute; left:0; top:0; width:100vw; height:100vh; z-index:3;"></div>
    <script>
      function startGameArea() {
        const gameArea = document.getElementById('gameArea');
        if (!gameArea) return;
        gameArea.innerHTML = '';
        const imgOptions = ['圖片/寵.webp','圖片/帽.webp','圖片/棒.webp','圖片/掃.webp','圖片/班.webp','圖片/石.webp','圖片/糖.webp','圖片/翻.webp','圖片/讀.webp','圖片/隱.webp'];
        let disappearCount = 0;
        const placed = [];
        function isOverlap(x,y,w,h) {
          for (const r of placed) {
            if (!(x + w < r.x || r.x + r.w < x || y + h < r.y || r.y + r.h < y)) return true;
          }
          return false;
        }
        function findPosition(imgW, imgH) {
          const maxAttempts = 50;
          const areaW = Math.max(0, gameArea.clientWidth - imgW);
          const areaH = Math.max(0, gameArea.clientHeight - imgH);
          for (let t=0; t<maxAttempts; t++) {
            const left = Math.random() * areaW;
            const top = Math.random() * areaH;
            if (!isOverlap(left, top, imgW, imgH)) return { left, top };
          }
          return { left: Math.random() * areaW, top: Math.random() * areaH };
        }
        for (let i=0; i<imgOptions.length; i++) {
          setTimeout(() => {
            const img = document.createElement('img');
            img.src = imgOptions[i];
            img.className = 'game-img';
            const imgW = 180;
            const imgH = 225;
            img.style.position = 'absolute';
            img.style.width = imgW + 'px';
            img.style.height = imgH + 'px';
            img.style.cursor = 'pointer';
            img.style.zIndex = 4;
            img.style.background = 'none';
            img.style.border = 'none';
            img.style.boxShadow = 'none';
            img.style.borderRadius = '0';
            const pos = findPosition(imgW, imgH);
            img.style.left = pos.left + 'px';
            img.style.top = pos.top + 'px';
            placed.push({ x: pos.left, y: pos.top, w: imgW, h: imgH });
            img.onclick = function() {
              img.style.display = 'none';
              disappearCount++;
              if (disappearCount === imgOptions.length) {
                setTimeout(function(){ showPage(7); }, 300);
              }
            };
            gameArea.appendChild(img);
            // 彈出動畫
            img.style.transform = 'scale(0.2)';
            img.style.opacity = '0';
            setTimeout(() => {
              img.style.transition = 'transform 260ms cubic-bezier(.2,.8,.2,1), opacity 260ms ease';
              img.style.transform = 'scale(1)';
              img.style.opacity = '1';
            }, 10);
          }, i * 220);
        }
      }
      // 監聽分頁切換
      const _oldShowPage = window.showPage;
      window.showPage = function(n) {
        _oldShowPage(n);
        if (n === 6) {
          setTimeout(startGameArea, 100);
        }
      };
    </script>
  </div>

  <!-- 第七頁：輸入咒語 -->
  <div id="page7" class="page" style="background-image: url('圖片/7.輸入咒語.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <div style="position: absolute; top: 60%; left: 50%; transform: translate(-50%, -50%);">
      <div style="background: rgba(201,203,207,0.75); border-radius: 24px; padding: 60px 80px; width: 800px; text-align: center; box-shadow: 0 5px 20px rgba(128,128,128,0.18);">
        <div style="font-size: 2.5rem; color: #222; margin-bottom: 60px; letter-spacing: 0.15em; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif;">輸入四字咒語</div>
        <div style="display: flex; justify-content: center; margin-bottom: 40px;">
          <input id="answer" type="text" maxlength="4" placeholder="_ _ _ _" style="font-size: 2.5rem; letter-spacing: 0.8rem; text-align: center; border: none; border-bottom: 3px solid #7691FF; outline: none; background: none; color: #000; width: 300px; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif; padding-bottom: 10px;" />
        </div>
        <button id="btnE" onclick="submitAnswer()" style="background: #7691FF; color: #fff; border: none; border-radius: 24px; padding: 14px 50px; font-size: 1.5rem; cursor: pointer; box-shadow: 0 2px 8px rgba(128,128,128,0.18); transition: background 0.2s; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif;">送出</button>
      </div>
    </div>
  </div>

  <!-- 第七頁-1 (答錯頁面) -->
  <div id="page7_1" class="page" style="background-image: url('圖片/7-1.答錯.webp'); background-size: cover; background-position: center;">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
      <div style="background: rgba(201,203,207,0.75); border-radius: 24px; padding: 60px 80px; width: 800px; text-align: center; box-shadow: 0 5px 20px rgba(128,128,128,0.18);">
        <div style="font-size: 1.8rem; color: #222; margin-bottom: 40px; line-height: 1.6; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif;">咒語似乎不對......<br>你意外得到一個千載難逢的機會，<br>木柵居民發現了關於咒語的提示，<br>要接受提示嗎？</div>
        <div style="display: flex; justify-content: center; gap: 20px;">
          <button id="btnGiveUp" onclick="giveUpPage7()" style="background: #7691FF; color: #fff; border: none; border-radius: 24px; padding: 14px 40px; font-size: 1.3rem; cursor: pointer; box-shadow: 0 2px 8px rgba(128,128,128,0.18); transition: background 0.2s; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif;">忍痛放棄</button>
          <button id="btnAccept" onclick="acceptHint()" style="background: #7691FF; color: #fff; border: none; border-radius: 24px; padding: 14px 40px; font-size: 1.3rem; cursor: pointer; box-shadow: 0 2px 8px rgba(128,128,128,0.18); transition: background 0.2s; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif;">當然好！</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 第七頁-2 (提示頁面) -->
  <div id="page7_2" class="page" style="background-image: url('圖片/7-2.提示.webp'); background-size: cover; background-position: center;">
    <div style="position: absolute; top: 50%; left: 64.5%; transform: translate(-50%, -50%);">      <div style="background: rgba(201,203,207,0.75); border-radius: 24px; padding: 60px 80px; width: 680px; text-align: center; box-shadow: 0 5px 20px rgba(128,128,128,0.18);">
        <div style="font-size: 1.8rem; color: #222; margin-bottom: 40px; line-height: 1.6; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif;">謎底提示：<br>政大山上校區的一棟建築物，<br>飛鼠の大本營！</div>
        <button id="btnRetry" onclick="retryAnswer()" style="background: #7691FF; color: #fff; border: none; border-radius: 24px; padding: 14px 50px; font-size: 1.5rem; cursor: pointer; box-shadow: 0 2px 8px rgba(128,128,128,0.18); transition: background 0.2s; font-family: '俐方體11號', 'Noto Sans TC', Arial, sans-serif;">重新作答</button>
      </div>
    </div>
  </div>

  <!-- 第八頁：答對 -->
  <div id="page8" class="page" style="background-image: url('圖片/8.答對.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <!-- 白框置中 -->
    <div style="position:absolute; top:60%; left:50%; transform:translate(-50%,-50%);">
      <div style="background:rgba(255,255,255,0.75); border-radius:24px; box-shadow:0 5px 20px rgba(128,128,128,0.18); padding:40.8px 60px 40.8px 60px; min-width:500px; max-width:700px; text-align:center; display:flex; align-items:center; justify-content:center; min-height:136px; font-family:'俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;">
        <div style="font-size:2rem; color:#222; line-height:1.6;">
          咒語成功！恭喜成功抓到飛鼠
        </div>
      </div>
    </div>
    <!-- 下一頁按鈕 -->
    <button id="nextAfterWin" onclick="showPage(9)" class="custom-btn" style="position:absolute; right:80px; top:50%; transform:translateY(-50%);">下一頁</button>
  </div>

  <!-- 第九頁：後續 -->
  <div id="page9" class="page" style="background-image: url('圖片/9.後續.webp'); background-size: cover; background-position: center;">
    <button class="back-btn" onclick="goBack()">⬅</button>
    <div style="position: absolute; top: 50%; left: 65%; transform: translate(-50%, -50%);">
      <div style="background: rgba(211,214,219,0.75); border-radius: 24px; padding: 48px 60px 38px 60px; min-width: 661px; max-width: 926px; text-align: center; box-shadow: 0 5px 20px rgba(128,128,128,0.18);">
        <div style="font-size: 2rem; color: #222; line-height: 1.6; margin-bottom: 32px; font-family: '俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;">
          木柵的一天平安的度過了，<br>但狡猾的飛鼠又秘密派人送來一樣禮物......
        </div>
        <button id="btn9" onclick="showPage(10)" style="background: #7691FF; color: #fff; border: none; border-radius: 24px; padding: 14px 50px; font-size: 1.3rem; cursor: pointer; box-shadow: 0 2px 8px rgba(128,128,128,0.18); transition: background 0.2s; font-family: '俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif; white-space: nowrap;">To Be Continue...</button>
      </div>
    </div>
  </div>

  <!-- 第十頁：製作團隊 -->
  <div id="page10" class="page" style="background-image: url('圖片/10.團隊.webp'); background-size: cover; background-position: center;">
    <div style="position: absolute; top: 10%; left: 50%; transform: translateX(-50%);">
      <div style="font-size: 2.5rem; color: #fff; font-weight: bold; font-family: '俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;">製作團隊</div>
    </div>
    <div style="position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%);">
     <button id="backToHome" onclick="location.reload()" style="background: rgba(118, 145, 255, 0.5); color: #fff; border: 2px solid #7691FF; border-radius: 24px; padding: 12px 40px; font-size: 1.2rem; cursor: pointer; transition: all 0.2s; font-family: '俐方體11號', 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif;">回首頁</button>
    </div>
  </div>


  <script>
    // 圖片預載函數
    function preloadImages(images) {
      return Promise.all(
        images.map(src => new Promise(resolve => {
          const img = new Image();
          img.onload = img.onerror = resolve;
          img.src = src;
        }))
      );
    }

    // 所有需要預載的圖片 URL
    const imagesToPreload = [
      '圖片/1.landing.webp',
      '圖片/2.轉折.webp',
      '圖片/3.視覺噪音.webp',
      '圖片/4.闖關說明.webp',
      '圖片/5.闖關完成.webp',
      '圖片/6.彈出式網頁.webp',
      '圖片/7.輸入咒語.webp',
      '圖片/7-1.答錯.webp',
      '圖片/7-2.提示.webp',
      '圖片/8.答對.webp',
      '圖片/9.後續.webp',
      '圖片/10.團隊.webp',
      '圖片/魔法師飛行.webp',
      '圖片/飛鼠被關.webp',
      '圖片/追逐飛鼠.webp',
      '圖片/寵.webp',
      '圖片/帽.webp',
      '圖片/棒.webp',
      '圖片/掃.webp',
      '圖片/班.webp',
      '圖片/石.webp',
      '圖片/糖.webp',
      '圖片/翻.webp',
      '圖片/讀.webp',
      '圖片/隱.webp'
    ];

    // 頁面加載完成後預載所有圖片
    window.addEventListener('load', () => {
      preloadImages(imagesToPreload).then(() => {
        console.log('所有圖片預載完成');
      });
    });

    // 分頁切換
    let currentPage = 1;
    let idleTimer = null;
    let autoBackTimer = null;
    function showPage(n) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById('page'+n).classList.add('active');
      currentPage = n;
      history.pushState({page:n}, '', '');
      if (autoBackTimer) clearTimeout(autoBackTimer);
      if (n === 1) startBannerTyping();
      if (n === 5) {
        autoBackTimer = setTimeout(() => {
          showPage(1);
        }, 1000 * 60 * 1); // 1分鐘
      }
      // 為所有文字框套用淡入動畫
      setTimeout(() => {
        const currentPageEl = document.getElementById('page'+n);
        if (currentPageEl) {
          const textBoxes = currentPageEl.querySelectorAll('[style*="background:rgba"], [style*="background: rgba"]');
          textBoxes.forEach(box => {
            box.style.animation = 'none';
            setTimeout(() => {
              box.style.animation = 'fadeIn 0.5s ease-in';
            }, 10);
          });
        }
      }, 50);
      // 第六頁自動啟動互動
      if (n === 6) {
        setTimeout(startGameArea, 1500);
      }
      // 第八頁按鈕立即顯示
      if (n === 8) {
        document.getElementById('nextAfterWin').style.display = 'block';
      } else {
        document.getElementById('nextAfterWin').style.display = 'none';
      }
        // 第六頁互動：自動彈出十張圖片，點擊消失，全部消失後進入第七頁
        function startGameArea() {
          const gameArea = document.getElementById('gameArea');
          if (!gameArea) return;
          gameArea.innerHTML = '';
          const imgOptions = ['圖片/寵.webp', '圖片/帽.webp', '圖片/棒.webp','圖片/掃.webp','圖片/班.webp','圖片/石.webp','圖片/糖.webp','圖片/翻.webp','圖片/讀.webp','圖片/隱.webp'];
          let disappearCount = 0;
          const placed = [];
          function isOverlap(x,y,w,h) {
            for (const r of placed) {
              if (!(x + w < r.x || r.x + r.w < x || y + h < r.y || r.y + r.h < y)) return true;
            }
            return false;
          }
          function findPosition(imgW, imgH) {
            const maxAttempts = 50;
            const areaW = Math.max(0, gameArea.clientWidth - imgW - 40);
            const areaH = Math.max(0, gameArea.clientHeight - imgH - 40);
            for (let t=0; t<maxAttempts; t++) {
              const left = Math.random() * areaW;
              const top = Math.random() * areaH;
              if (!isOverlap(left, top, imgW, imgH)) return { left, top };
            }
            return { left: Math.random() * areaW, top: Math.random() * areaH };
          }
          for (let i=0; i<imgOptions.length; i++) {
            setTimeout(() => {
              const img = document.createElement('img');
              img.src = imgOptions[i];
              img.className = 'game-img';
              const imgW = 180;
              const imgH = 225;
              img.style.position = 'absolute';
              img.style.width = imgW + 'px';
              img.style.height = imgH + 'px';
              img.style.boxShadow = '0 0 0 3px #fff';
              img.style.borderRadius = '12px';
              img.style.cursor = 'pointer';
              img.style.background = '#eee';
              img.style.zIndex = 4;
              const pos = findPosition(imgW, imgH);
              img.style.left = pos.left + 'px';
              img.style.top = pos.top + 'px';
              placed.push({ x: pos.left, y: pos.top, w: imgW, h: imgH });
              img.onclick = function() {
                img.style.display = 'none';
                disappearCount++;
                if (disappearCount === imgOptions.length) {
                  setTimeout(function(){ showPage(7); }, 300);
                }
              };
              gameArea.appendChild(img);
              // 彈出動畫
              img.style.transform = 'scale(0.2)';
              img.style.opacity = '0';
              setTimeout(() => {
                img.style.transition = 'transform 260ms cubic-bezier(.2,.8,.2,1), opacity 260ms ease';
                img.style.transform = 'scale(1)';
                img.style.opacity = '1';
              }, 10);
            }, i * 220);
          }
        }
    }
    // 返回按鈕
    function goBack() {
      if (currentPage > 1) showPage(currentPage-1);
    }
    // 第一頁按鈕
    document.getElementById('startBtn').onclick = function() { showPage(2); };
    // 第二頁按鈕
    document.getElementById('btn2').onclick = function() { showPage(3); };
    // 第三頁按鈕
    document.getElementById('btn3').onclick = function() { showPage(4); };
    // 第四頁按鈕
    document.getElementById('btn4').onclick = function() { showPage(5); };
    // 第五頁按鈕
    document.getElementById('btn5').onclick = function() { showPage(6); };
    // 第六頁小遊戲（彈跳視窗）
    document.getElementById('btnD').onclick = function() {
      document.getElementById('gameHint').style.display = 'block';
      const gameArea = document.getElementById('gameArea');
      gameArea.innerHTML = '';
      let disappearCount = 0;
      const imgOptions = ['圖片/寵.webp', '圖片/帽.webp', '圖片/棒.webp','圖片/掃.webp','圖片/班.webp','圖片/石.webp','圖片/糖.webp','圖片/翻.webp','圖片/讀.webp','圖片/隱.webp',];
      const placed = [];
      function isOverlap(x,y,w,h) {
        for (const r of placed) {
          if (!(x + w < r.x || r.x + r.w < x || y + h < r.y || r.y + r.h < y)) return true;
        }
        return false;
      }
      function findPosition(imgW, imgH) {
        const maxAttempts = 50;
        // 限制圖片不覆蓋最上方白色對話框（假設對話框高度約160px）
        const safeTop = 180; // 對話框底部以下
        const areaW = Math.max(0, gameArea.clientWidth - imgW - 40);
        const areaH = Math.max(0, gameArea.clientHeight - imgH - safeTop - 40);
        for (let t=0; t<maxAttempts; t++) {
          const left = Math.random() * areaW + 20;
          const top = Math.random() * areaH + safeTop;
          if (!isOverlap(left, top, imgW, imgH)) return { left, top };
        }
        // fallback: return random even if overlapping
        return { left: Math.random() * areaW + 20, top: Math.random() * areaH + safeTop };
      }
      for (let i=0; i<imgOptions.length; i++) {
        setTimeout(() => {
          const img = document.createElement('img');
          img.src = imgOptions[i];
          img.className = 'game-img';
          const imgW = 240;
          const imgH = Math.round(imgW * 5 / 4);
          img.style.width = imgW + 'px';
          img.style.height = imgH + 'px';
          const pos = findPosition(imgW, imgH);
          img.style.left = pos.left + 'px';
          img.style.top = pos.top + 'px';
          placed.push({ x: pos.left, y: pos.top, w: imgW, h: imgH });
          img.onclick = function() {
            this.style.display = 'none';
            disappearCount++;
            if (disappearCount === imgOptions.length) showPage(7);
          };
          gameArea.appendChild(img);
          requestAnimationFrame(() => img.classList.add('enter'));
        }, i * 220);
      }
    };
    // 第七頁咒語驗證函數
    function submitAnswer() {
      let val = document.getElementById('answer').value.trim();
      console.log('輸入值:', val);
      if (val === '自強九舍') {
        console.log('驗證成功，進入第八頁');
        showPage(8);
      } else {
        console.log('驗證失敗，進入7-1頁');
        showPage('7_1');
      }
    }
    // 第七頁-1忍痛放棄按鈕
    function giveUpPage7() {
      showPage(7);
    }
    // 第七頁-1當然好按鈕
    function acceptHint() {
      showPage('7_2');
    }
    // 第七頁-2重新作答按鈕
    function retryAnswer() {
      showPage(7);
    }
    // 第八頁下一頁按鈕已透過 onclick 屬性綁定
    // 第九頁再來一次按鈕
    function goToStart() {
      showPage(1);
    };

  </script>
</body>
</html>

